<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ü—Ä–æ—Ñ–∏–ª—å XGRAM</title>
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/dark.css" id="theme-link">
</head>
<body>
<div class="header">
  <h1>–ü—Ä–æ—Ñ–∏–ª—å</h1>
  <div id="admin-btn" class="hidden" onclick="openAdmin()">‚ö° Admin</div>
</div>

<div id="profile-info"></div>
<div>
  <h3>–ü–æ–¥–∞—Ä–∫–∏</h3>
  <ul id="gift-list"></ul>
</div>

<script type="module">
import { db } from './js/firebase.js';
import { ref, get, set, push } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const currentUser = localStorage.getItem("currentUser");
if (currentUser === "cell") document.getElementById("admin-btn").classList.remove("hidden");
window.openAdmin = () => window.location.href = "admin.html";

async function loadProfile() {
  const userSnap = await get(ref(db, 'users/' + currentUser));
  if (!userSnap.exists()) return;
  const data = userSnap.val();
  document.getElementById("profile-info").innerHTML = `
    <p>–ù–∏–∫: ${data.login}</p>
    <p>–ó–≤—ë–∑–¥—ã: ${data.stars}</p>
    <p>–ü–æ–¥–∞—Ä–∫–∏: ${data.gifts}</p>
    <p>–°—Ç–∞—Ç—É—Å: ${data.status}</p>
  `;
}

async function loadGifts() {
  const gifts = ["üíé Diamond Heart","üî• Flame Dragon","üëë King Crown","üéÜ Galaxy Burst","üåô Moon Aura","üí´ Star Shower","üéÅ Magic Box","üçÄ Lucky Leaf","üíê Flower Bomb","üéà Balloons"];
  const ul = document.getElementById("gift-list");
  ul.innerHTML = "";
  gifts.forEach(g => {
    const li = document.createElement("li");
    li.innerText = g + " ";
    const btn = document.createElement("button");
    btn.innerText = "–ü–æ–¥–∞—Ä–∏—Ç—å";
    btn.onclick = () => alert(`–í—ã –ø–æ–¥–∞—Ä–∏–ª–∏ ${g}`);
    li.appendChild(btn);
    ul.appendChild(li);
  });
}

loadProfile();
loadGifts();
</script>
<script type="module" src="js/theme.js"></script>
</body>
</html>
